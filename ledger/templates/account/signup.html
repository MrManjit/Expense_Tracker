{% extends "ledger/base.html" %}
{% load static %}
{% load socialaccount %}

{% block title %}Sign Up - Expense Tracker{% endblock %}

{% block body_class %}signup-page{% endblock %}

{% block content %}
<style>
    /* Prevent whole-page scrolling on signup while keeping the card scrollable */
    body.signup-page { overflow: hidden; }

    .login-container {
        position: fixed;
        top: 100px;
        left: 60px;
        right: 60px;
        bottom: 40px;
        background-image: linear-gradient(135deg, rgba(188, 205, 199, 0.8) 0%, rgba(173, 176, 143, 0.8) 100%), url('https://images.unsplash.com/photo-1554224155-6726b3ff858f?auto=format&fit=crop&w=1920&q=80');
        background-position: center 55%;
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-size: cover;
        display: flex; align-items: center; justify-content: center;
        padding: 20px; position: fixed; overflow-y: auto; -webkit-overflow-scrolling: touch; z-index: 1050;
    }
    .login-container::before { content:''; position:absolute; inset:0; background:rgba(0,0,0,0.3); z-index:1; }
    .login-card {
        background: rgba(255,255,255,0.98); backdrop-filter: blur(20px);
        border-radius: 20px; box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        max-width: 550px; width: 100%; position: relative; z-index:2; overflow: hidden;
        display: flex;
        flex-direction: column;
        max-height: calc(100vh - 120px);
    }
    .login-header {
        background: linear-gradient(135deg, #2c5530 0%, #1e7b3d 100%);
        color:white; padding:30px 20px; text-align:center;
        margin: -20px -20px 20px -20px;
    }

    /* make the form area scrollable when viewport is constrained and reserve gutter */
    .login-card .card-body {
        padding: 16px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        scrollbar-gutter: stable;
    }
    .login-header h4 { margin:0; font-size:28px; font-weight:600; }
    .login-icon { font-size:48px; margin-bottom:10px; opacity:0.9; }

    /* two-column responsive form rows to reduce vertical length */
    .form-row { display: flex; gap: 12px; }
    .form-row .form-group { flex: 1; min-width: 0; }
    @media (max-width: 768px) {
        .form-row { flex-direction: column; }
    }

    .form-control { border-radius:10px; border:2px solid #e9ecef;
        padding:12px 16px; font-size:16px; transition:all .3s ease; width:100%; }
    .form-control:focus { border-color:#2c5530; box-shadow:0 0 0 .2rem rgba(46,125,50,0.25); }
    .form-group { margin-bottom:1rem; }
    .form-label { font-weight:600; color:#495057; margin-bottom:8px; }

    .btn-login {
        background:linear-gradient(135deg, #2c5530 0%, #1e7b3d 100%);
        border:none; border-radius:10px; padding:12px 30px; width:100%;
        color:white; font-size:16px; font-weight:600; transition:all .3s ease;
        box-shadow:0 4px 15px rgba(46,125,50,.3);
    }
    .btn-login:hover {
        transform:translateY(-2px);
        box-shadow:0 10px 25px rgba(46,125,50,.4);
        background:linear-gradient(135deg, #1e7b3d 0%, #2c5530 100%);
    }

    .helper-link { color:#1e7b3d; font-weight:600; text-decoration:none; }
    .helper-link:hover { text-decoration:underline; }

    @media (prefers-color-scheme: dark) {
        .login-card { background:rgba(28,28,28,0.9); }
        .form-label { color:#e8eaed; }
        .helper-link { color:#8bd79e; }
    }

    @media (max-width: 576px) {
        .login-card { max-width: 92vw; border-radius: 12px; max-height: calc(100vh - 40px); }
        .login-header { padding: 16px; margin-bottom: 8px; }
        .login-card .card-body { padding: 12px; }
        .btn-login { padding: 10px 16px; }
    }
</style>

<div class="login-container">
    <div class="login-card">

        <div class="login-header">
            <div class="login-icon">üìù</div>
            <h4>Create Your Account</h4>
            <p class="mb-0 opacity-75">Join the Expense Tracker</p>
        </div>

        <div class="card-body p-4">

            <form method="post" action="">
                {% csrf_token %}

                {% if form.non_field_errors %}
                    <div class="alert alert-danger">
                        {% for error in form.non_field_errors %}
                            {{ error }}
                        {% endfor %}
                    </div>
                {% endif %}

                <!-- FIRST + LAST NAME (same row) -->
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">First Name</label>
                        <input type="text" name="first_name" class="form-control"
                               value="{{ form.first_name.value|default:'' }}" required>
                        {% if form.first_name.errors %}
                            <div class="text-danger mt-1">{{ form.first_name.errors }}</div>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label class="form-label">Last Name</label>
                        <input type="text" name="last_name" class="form-control"
                               value="{{ form.last_name.value|default:'' }}" required>
                        {% if form.last_name.errors %}
                            <div class="text-danger mt-1">{{ form.last_name.errors }}</div>
                        {% endif %}
                    </div>
                </div>

                <!-- USERNAME + EMAIL (same row) -->
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Username</label>
                        <input type="text" name="username" class="form-control"
                               value="{{ form.username.value|default:'' }}" required>
                        {% if form.username.errors %}
                            <div class="text-danger mt-1">{{ form.username.errors }}</div>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" name="email" class="form-control"
                               value="{{ form.email.value|default:'' }}" required>
                        {% if form.email.errors %}
                            <div class="text-danger mt-1">{{ form.email.errors }}</div>
                        {% endif %}
                    </div>
                </div>

                <!-- PASSWORDS (same row) -->
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" name="password1" class="form-control" required>
                        {% if form.password1.errors %}
                            <div class="text-danger mt-1">{{ form.password1.errors }}</div>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label class="form-label">Confirm Password</label>
                        <input type="password" name="password2" class="form-control" required>
                        {% if form.password2.errors %}
                            <div class="text-danger mt-1">{{ form.password2.errors }}</div>
                        {% endif %}
                    </div>
                </div>

                <div class="d-grid gap-2 mb-3">
                    <button type="submit" class="btn btn-login">Create Account</button>
                </div>

                <div>
                    {% url 'account_login' as login_url %}
                    <a href="{{ login_url }}">Already have an account? Log in</a>
                </div>

            </form>

        </div>
    </div>
</div>


<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}